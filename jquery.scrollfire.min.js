/**
 * jQuery.scrollfire()
 *
 * (a) Wil Neeley, Trestle Media, LLC.
 * Code may be freely distributed under the MIT license.
 */
(function(d,f,h,b){var i="scrollfire",g=null,c={onScroll:function(){},onScrollDown:function(){},onScrollUp:function(){},onScrollDownAlways:function(){},onScrollUpAlways:function(){},onTopIn:function(){},onTopOut:function(){},onBottomIn:function(){},onBottomOut:function(){},parallax:{childOf:null,speed:1},offset:0,topInOffset:0,topOutOffset:0,bottomInOffset:0,bottomOutOffset:0},e={registry:{},guid:0,last_scroll_pos:0,scroll_handler:null};function j(l,k){this.element=l;this.options=d.extend({},c,k);this._defaults=c;this._name=i;this.init()}j.prototype.init=function(){var m=this;var k={_guid:e.guid,_element:m.element,_on_scroll:m.options.onScroll,_on_scroll_down:m.options.onScrollDown,_on_scroll_up:m.options.onScrollUp,_on_scroll_down_always:m.options.onScrollDownAlways,_on_scroll_up_always:m.options.onScrollUpAlways,_on_top_in:m.options.onTopIn,_on_top_in_once:true,_on_top_out:m.options.onTopOut,_on_top_out_once:true,_on_bottom_in:m.options.onBottomIn,_on_bottom_in_once:true,_on_bottom_out:m.options.onBottomOut,_on_bottom_out_once:true,_offset:m.options.offset,_top_in_offset:m.options.topInOffset,_top_out_offset:m.options.topOutOffset,_bottom_in_offset:m.options.bottomInOffset,_bottom_out_offset:m.options.bottomOutOffset,_parallax:m.options.parallax};var n=function(q){var o=d(f).scrollTop();var p=(o>e.last_scroll_pos)?"down":"up";var r=Math.abs(e.last_scroll_pos-o);d.each(e.registry,function(A,F){if(p=="down"){var C=d(F._element).offset().top;var z=o>=(C+(F._top_out_offset?-F._top_out_offset:-F._offset));var B=(o+d(f).outerHeight())>=(C+(F._bottom_in_offset?F._bottom_in_offset:F._offset));var u=(o<=(C+d(F._element).outerHeight()));var v=(o+d(f).outerHeight())>C;F._on_scroll(F._element,r,p);F._on_scroll_down_always(F._element,r);if(u&&v){var H=d(f).outerHeight();var w=(C+d(F._element).outerHeight())-o;var G=(w/H);G=(G>1)?1:G.toFixed(2);F._on_scroll_down(F._element,r,G);if(F._parallax.childOf&&(w>=F._offset)){var x=d(F._element).position().top;var s=(x-(r*F._parallax.speed));if(s>=0){d(F._element).css("top",s)}}}if(z&&F._on_top_out_once){F._on_top_in_once=true;F._on_top_out_once=false;F._on_top_out(F._element,r)}if(B&&F._on_bottom_in_once){F._on_bottom_out_once=true;F._on_bottom_in_once=false;F._on_bottom_in(F._element,r)}}else{var C=d(F._element).offset().top+d(F._element).outerHeight();var y=o<=(C+(F._top_in_offset?-F._top_in_offset:-F._offset));var E=(o+d(f).outerHeight())<=(C+(-F._bottom_out_offset?-F._bottom_out_offset:F._offset));var u=o<C;var v=((o+d(f).outerHeight())+d(F._element).outerHeight())>C;F._on_scroll(F._element,r,p);F._on_scroll_up_always(F._element,r);if(u&&v){var H=d(f).outerHeight();var w=(C)-o;var G=(w/H);G=(G>1)?1:G.toFixed(2);F._on_scroll_up(F._element,r,G);if(F._parallax.childOf){var x=d(F._element).position().top;var s=(x+(r*F._parallax.speed));var t=F._parallax.childOf.css("padding-bottom").replace(/px/g,"");var D=(t=="0")?d(F._element).outerHeight():d(F._element).height();if((s+D-t)<=F._parallax.childOf.height()){d(F._element).css("top",s)}}}if(y&&F._on_top_in_once){F._on_top_out_once=true;F._on_top_in_once=false;F._on_top_in(F._element,r)}if(E&&F._on_bottom_out_once){F._on_bottom_in_once=true;F._on_bottom_out_once=false;F._on_bottom_out(F._element,r)}}});e.last_scroll_pos=o};k._scroll_handler=n;e.registry[e.guid]=k;if(!d.data(m.element,"uids")){d.data(m.element,"uids",[e.guid])}else{var l=d.data(m.element,"uids");l.push(e.guid);d.data(m.element,"uids",l)}e.guid++;if(!e.scroll_handler){e.scroll_handler=n;d(f).bind("scroll",n)}};var a={remove:function(k){k.each(function(l,n){var m=d(n).data("uids");if(m){delete e.registry[m]}});return g}};d.fn[i]=function(l){g=this;if(typeof l=="string"){var m=l;var k=d(arguments).toArray();k.shift();k.unshift(this);return a[m].apply(this,k)}else{return this.each(function(){d.data(this,"plugin_"+i,new j(this,l))})}}})(jQuery,window,document);